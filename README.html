<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>README.html</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

</head>

<body>

<h1 id="sketchdb">sketchdb</h1>
<h3 id="about">About</h3>
<p>This is a small file/directory based app for Node JS that provides
some basic database functionality for storing key-value pairs in
table/row/entry format as .json files.</p>
<p>The purpose of this library is to provide a simple database-like
storage system for things like small personal projects or prototyping.
It is written to be easy to setup and use.</p>
<p>This library requires no dependencies.</p>
<h3 id="installation">Installation</h3>
<p>run</p>
<pre class="console"><code>npm install sketchdb</code></pre>
<p>in your project’s directory to install a local node module.</p>
<h2 id="usage">Usage</h2>
<h3 id="setup">Setup</h3>
<p>run</p>
<pre class="console"><code>npm exec sketchdb-setup</code></pre>
<p>from the top level of your project directory to setup an instance of
sketchdb.</p>
<p>Alternatively, call sketchdb.setup() from inside a script (note -
sketchdb.setup() is async and returns a promise)</p>
<p>The setup application will create a new directory in that top level
directory of the project named “sketchdb_store” where data will be
stored, along with a subdirectory named “tables”. (that’s all
sketchdb-setup does)</p>
<p>External edits to directories and files in sketchdb_store will
reflect in the database as long as they are proper JSON.</p>
<h3 id="api">API</h3>
<p>All function calls to sketchdb return a Promise.</p>
<p>Calls to retrieve data will resolve to that data or reject with an
error.</p>
<p>Calls to write data or perform a delete operation will resolve with
true on success (this will probably change to an object of some sort
with more info but haven’t decided yet)</p>
<h3 id="methods">Methods</h3>
<ul>
<li><a href="#list_tables">sketchdb.list_tables</a></li>
<li><a href="#create_table">sketchdb.create_table</a></li>
<li><a href="#insert">sketchdb.insert</a></li>
<li><a href="#get_row">sketchdb.get_row</a></li>
<li><a href="#get_all">sketchdb.get_all</a></li>
<li><a href="#update">sketchdb.update</a></li>
<li><a href="#delete_row">sketchdb.delete_row</a></li>
<li><a href="#delete_table">sketchdb.delete_table</a></li>
<li><a href="#filter">sketchdb.filter</a></li>
<li><a href="#rename_table">sketchdb.rename_table</a></li>
</ul>
<h3 id="sketchdb.list_tables"><a name="list_tables"></a>
sketchdb.list_tables</h3>
<p>List the tables in the database in array format.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">list_tables</span>()</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<p>none</p>
<p><strong>Return value:</strong> Returns a Promise. When resolved,
Promise returns an array of the table names as strings.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">list_tables</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(results) {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">do_something_with_results</span>()<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Results will be an array like [&quot;users&quot;,&quot;posts&quot;,&quot;authors&quot;]</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.create_table"><a name="create_table"></a>
sketchdb.create_table</h3>
<p>Creates a new table in the database.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">create_table</span>(<span class="st">&#39;table_name&#39;</span>)</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<p><em>table_name:</em> The name of the table to create (as a
string)</p>
<p><strong>Return value:</strong> Returns a Promise. Resolves with true.
Rejects with an error if the table exists.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">create_table</span>(<span class="st">&#39;users&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(success_function)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(error_handler)<span class="op">;</span></span></code></pre></div>
<p><strong>Note:</strong> You can also create a table by making a
subdirectory in “./sketchdb_store/tables/” with the table name.</p>
<h3 id="sketchdb.insert"><a name="insert"></a> sketchdb.insert</h3>
<p>Insert a new row into a given table in the database.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">insert</span>(table_name<span class="op">,</span> id<span class="op">,</span> data)</span></code></pre></div>
<p>Or let sketchdb generate a unique id:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">insert</span>(table_name<span class="op">,</span> data)</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<ul>
<li><em>table_name</em> (string): Table to insert into.</li>
<li><em>id</em> (string, optional): Unique row id. (Optional, will
auto-generate if omitted)</li>
<li><em>data</em> (object or JSON string): Data to store as JSON.</li>
</ul>
<p><strong>Return value:</strong> Returns a Promise. Resolves with the
id.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> user <span class="op">=</span> { <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;John&#39;</span><span class="op">,</span> <span class="dt">group</span><span class="op">:</span> <span class="st">&#39;1&#39;</span> }<span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">insert</span>(<span class="st">&#39;users&#39;</span><span class="op">,</span> user)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(<span class="kw">function</span>(id) {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// use the returned unique id</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.get_row"><a name="get_row"></a> sketchdb.get_row</h3>
<p>Retrieve a row from a given table.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">get_row</span>(table_name<span class="op">,</span> id)</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<ul>
<li><em>table_name</em> (string): Table name</li>
<li><em>id</em> (string): Row id</li>
</ul>
<p><strong>Return value:</strong> Resolves to the data object for the
row, or rejects if not found.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">get_row</span>(<span class="st">&#39;users&#39;</span><span class="op">,</span> <span class="st">&#39;178&#39;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(do_something)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.get_all"><a name="get_all"></a> sketchdb.get_all</h3>
<p>Retrieve all rows from a given table as an array.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">get_all</span>(table_name)</span></code></pre></div>
<p><strong>Return value:</strong> Resolves to an array of row objects.
Rejects if table not found.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">get_all</span>(<span class="st">&#39;users&#39;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(process_all_users)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.update"><a name="update"></a> sketchdb.update</h3>
<p>Update a row with new or replacement data.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">update</span>(table_name<span class="op">,</span> id<span class="op">,</span> data)</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<ul>
<li><em>table_name</em> (string): Table name</li>
<li><em>id</em> (string): Row id</li>
<li><em>data</em> (object): Data to merge/update</li>
</ul>
<p><strong>Return value:</strong> Resolves with true on success, rejects
on error.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">update</span>(<span class="st">&#39;users&#39;</span><span class="op">,</span> <span class="st">&#39;uq13g564d&#39;</span><span class="op">,</span> { <span class="dt">group</span><span class="op">:</span> <span class="st">&#39;2&#39;</span> })</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(success_function)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.delete_row"><a name="delete_row"></a>
sketchdb.delete_row</h3>
<p>Delete a row from a table.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">delete_row</span>(table_name<span class="op">,</span> id)</span></code></pre></div>
<p><strong>Return value:</strong> Resolves with true on success.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">delete_row</span>(<span class="st">&#39;users&#39;</span><span class="op">,</span> <span class="st">&#39;178&#39;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(success_function)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.delete_table"><a name="delete_table"></a>
sketchdb.delete_table</h3>
<p>Delete an entire table and its rows.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">delete_table</span>(table_name)</span></code></pre></div>
<p><strong>Return value:</strong> Resolves with true on success.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">delete_table</span>(<span class="st">&#39;students&#39;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(success_function)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.filter"><a name="filter"></a> sketchdb.filter</h3>
<p>Return an array of all rows in a table with a given key/value
pair.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">filter</span>(table_name<span class="op">,</span> key<span class="op">,</span> value)</span></code></pre></div>
<p><strong>Return value:</strong> Resolves to array of row objects with
matching key/value.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">filter</span>(<span class="st">&#39;users&#39;</span><span class="op">,</span> <span class="st">&#39;group&#39;</span><span class="op">,</span> <span class="st">&#39;superuser&#39;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(<span class="bu">console</span><span class="op">.</span><span class="fu">log</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>
<h3 id="sketchdb.rename_table"><a name="rename_table"></a>
sketchdb.rename_table</h3>
<p>Rename a table.</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">rename_table</span>(table<span class="op">,</span> new_name)</span></code></pre></div>
<p><strong>Return value:</strong> Resolves with true on success.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">rename_table</span>(<span class="st">&#39;authors&#39;</span><span class="op">,</span> <span class="st">&#39;contributors&#39;</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(success_function)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>
<hr />
<h3 id="sketchdb.move_row"><a name="move_row"></a>
sketchdb.move_row</h3>
<p>Move a row from one table to another (retaining the same row id).</p>
<p><strong>Syntax:</strong></p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">move_row</span>(from_table<span class="op">,</span> to_table<span class="op">,</span> id)</span></code></pre></div>
<p><strong>Parameters:</strong></p>
<ul>
<li><em>from_table</em> (string): The table to move the row
<strong>from</strong></li>
<li><em>to_table</em> (string): The table to move the row
<strong>to</strong></li>
<li><em>id</em> (string): The id of the row to move</li>
</ul>
<p><strong>Return value:</strong> Resolves with true on success. Rejects
with an error if the source row does not exist, or the destination
already has the id.</p>
<p><strong>Example usage:</strong></p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sketchdb<span class="op">.</span><span class="fu">move_row</span>(<span class="st">&#39;drafts&#39;</span><span class="op">,</span> <span class="st">&#39;posts&#39;</span><span class="op">,</span> <span class="st">&#39;12345&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">then</span>(() <span class="kw">=&gt;</span> <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&#39;Row moved!&#39;</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">catch</span>(handle_error)<span class="op">;</span></span></code></pre></div>

</body>
</html>
